from bs4 import BeautifulSoup
import lxml
import pandas as pd
dlist=[]
file1 = '/Users/stanislavdidenko/PycharmProjects/pythonProject2/.venv/p1.xml'
file2 ='/Users/stanislavdidenko/PycharmProjects/pythonProject2/.venv/v1.xml'
files=[file1,file2]
itemdatas=[]
def onlyvalues(list):
    newlist=[]
    for l in list:
        if type(l)==str:
            newlist.append(l)
        elif l !=None :
            newlist.append(l.text)
        else:
            newlist.append('-')
    return newlist

def coolpower(dlist):
    for li in dlist:

        if 'Гликолевый рекуператор' in li[0]:
            li[9]=li[13]
            li[13]="-"
    return dlist



def createAHU(list):
    correctlist=[]
    for l in list[0]:
        m = len(list) - 1
        if l=="-":
            nc=list[0].index(l)
            for i in range(m):
                if list[i][nc]!='-':
                    list[0][nc]=list[i][nc]
    correctlist=list[0][1:]
    return correctlist



with (open (file2, 'r') as file):
    soups=BeautifulSoup(file,'lxml').find_all('item')
    ahulist=[]
    totallist=[]
    for soup in soups:
        list=[]

        sign = file.name.split('/')[-1].split('.')[0]
        chaneltype=soup.find('chaneltype')
        name = soup.find('name')
        flowwork = soup.find('flowwork')
        pressurework = soup.find('pressurework')
        revnominalwheel=soup.find('revnominalwheel')
        revwork = soup.find('revwork')
        nominalpower = soup.find('nominalpower')
        ifrequency=soup.find('ifrequency')
        tglycolinflow = soup.find('tglycolinflow')
        tglycoloutflow = soup.find('tglycoloutflow')
        qneed = soup.find('qneed')
        kpd=soup.find('kpd')
        glycoldp = soup.find('glycoldp')
        tinairinflow = soup.find('tinairinflow')
        toutairoutflow = soup.find('toutairoutflow')
        tairmax=soup.find('tairmax')
        droppressurewater = soup.find('droppressurewater')
        cleaningclass=soup.find('cleaningclass')
        glneed=None
        list=(name,sign,flowwork,pressurework,revnominalwheel, nominalpower,revwork,tinairinflow,\
                    toutairoutflow,glneed,kpd,toutairoutflow,tairmax,qneed,droppressurewater, cleaningclass)
        #print(list)
        newlist=onlyvalues(list)
        totallist.append(newlist)
    totallist= coolpower(totallist)
    #print (totallist)



    #print (totallist[4])
    print(createAHU(totallist))
